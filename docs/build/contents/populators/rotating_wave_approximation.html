

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Rotating Wave Approximation &mdash; MarS 2026.01.11 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=7e9183e1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Propagator-Based Density Matrix Evolution" href="propagator_computation.html" />
    <link rel="prev" title="Level-Based Kinetic Approach" href="level_based_kynetic.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            MarS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quick Start</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../base_spin_system.html">Base Spin System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sample.html">Sample Representation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spectrum_constraction.html">EPR Spectrum Construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fitting_tutorial.html">Fitting Spectroscopic Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interactions/index.html">Interactions in MarS</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Population Computation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#core-concepts">Core Concepts</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#module-components">Module Components</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="stationary_spectra.html">Stationary Spectra Population</a></li>
<li class="toctree-l3"><a class="reference internal" href="level_based_kynetic.html">Level-Based Kinetic Approach</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Rotating Wave Approximation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#theory">Theory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#constraints-and-limitations">Constraints and Limitations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#powder-averaging">Powder Averaging</a></li>
<li class="toctree-l4"><a class="reference internal" href="#applicability">Applicability</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="propagator_computation.html">Propagator-Based Density Matrix Evolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="detailed_balance.html">Detailed Balance Enforcement</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../context/index.html">Relaxation Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spectra_creators/index.html">Spectra Creators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intensity_calculators/index.html">Transition Intensity Calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../meshers/index.html">Meshing Strategies</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/mars.html">mars package</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorial Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples/example_1.html">Continuous-Wave EPR Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/example_2.html">Polarized Radiation EPR Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/example_3.html">Fitting Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/example_4.html">Advance Fitting Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/example_5.html">Spectra Polarization and Time Resolved</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/example_6.html">Multi-System Kinetic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/example_7.html">Time-Resolved Fitting Procedures</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Info</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/ArkadySamsonenkoWork/MarS.git"> GitHub Repository</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MarS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Population Computation</a></li>
      <li class="breadcrumb-item active">Rotating Wave Approximation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/contents/populators/rotating_wave_approximation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="rotating-wave-approximation">
<span id="id1"></span><h1>Rotating Wave Approximation<a class="headerlink" href="#rotating-wave-approximation" title="Link to this heading"></a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h2>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">mars.population.populators.density_population.RWADensityPopulator</span></code> computes time-dependent EPR signals using the full density matrix formalism under the Rotating Wave Approximation (RWA).
This approach efficiently models coherent evolution and relaxation when specific physical constraints are satisfied. This is default method for <code class="xref py py-class docutils literal notranslate"><span class="pre">mars.spectra_manager.spectra_manager.DensityTimeSpectra</span></code></p>
</section>
<section id="theory">
<h2>Theory<a class="headerlink" href="#theory" title="Link to this heading"></a></h2>
<section id="liouville-von-neumann-equation">
<h3>Liouville-von Neumann Equation<a class="headerlink" href="#liouville-von-neumann-equation" title="Link to this heading"></a></h3>
<p>The density matrix ρ(t) evolves according to:</p>
<div class="math notranslate nohighlight">
\[\frac{d\rho}{dt} = -i[H, \rho] + \hat{R}[\rho]\]</div>
<p>where:</p>
<ul class="simple">
<li><p><strong>H</strong>: Spin Hamiltonian</p></li>
<li><p><strong>R</strong>: Relaxation superoperator describing decoherence and population transfer</p></li>
</ul>
<p>To solve this numerically, the equation is transformed into Liouville space where the density matrix becomes a vector of dimension N^2 and operators become N^2xN^2 superoperators:</p>
<div class="math notranslate nohighlight">
\[\frac{d\hat{\rho}}{dt} = (-i\hat{H} + \hat{R})\hat{\rho}\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[\hat{H} = H \otimes I - I \otimes H\]</div>
</section>
<section id="rotating-frame-transformation">
<h3>Rotating Frame Transformation<a class="headerlink" href="#rotating-frame-transformation" title="Link to this heading"></a></h3>
<p>For time-dependent Hamiltonians oscillating at the spectrometer frequency w, the RWA eliminates rapidly oscillating terms by transforming to a rotating reference frame:</p>
<div class="math notranslate nohighlight">
\[\tilde{\rho} = e^{i\omega S_z t} \rho e^{-i\omega S_z t}\]</div>
<p>In the rotating frame, the effective Hamiltonian becomes time-independent and for isotropic g-tensor can be written as:</p>
<div class="math notranslate nohighlight">
\[H_{\text{eff}} = F + g\mu_B(B_0 - \omega/g\mu_B)S_z + g\mu_B B_1 S_x\]</div>
<p>where:</p>
<ul class="simple">
<li><p><strong>F</strong>: Zero-field Hamiltonian (exchange, dipolar, zero-field splitting)</p></li>
<li><p><strong>B0</strong>: Static magnetic field</p></li>
<li><p><strong>B1</strong>: Microwave field amplitude</p></li>
<li><p><strong>w</strong>: Spectrometer frequency</p></li>
</ul>
</section>
</section>
<section id="constraints-and-limitations">
<h2>Constraints and Limitations<a class="headerlink" href="#constraints-and-limitations" title="Link to this heading"></a></h2>
<p>In MarS, the RWA imposes strict requirements on the spin system:</p>
<section id="close-to-isotropic-g-tensor">
<h3>Close to Isotropic g-Tensor<a class="headerlink" href="#close-to-isotropic-g-tensor" title="Link to this heading"></a></h3>
<p>The Zeeman operators must be proportional to the spin operators:</p>
<div class="math notranslate nohighlight">
\[G_x = g_x\mu_B S_x, \quad G_y = g_y\mu_B S_y, \quad G_z = g_z\mu_B S_z.\]</div>
<p>To compute RWA, by default, MarS modifies the Zeeman operators <span class="math notranslate nohighlight">\(G_x\)</span>, <span class="math notranslate nohighlight">\(G_y\)</span>, and <span class="math notranslate nohighlight">\(G_z\)</span> so that they approximately commute with the total spin projection operators <span class="math notranslate nohighlight">\(S_x\)</span>, <span class="math notranslate nohighlight">\(S_y\)</span>, and <span class="math notranslate nohighlight">\(S_z\)</span>, respectively:</p>
<div class="math notranslate nohighlight">
\[[G_\alpha, S_\alpha] \approx 0 \quad \text{for} \quad \alpha \in \{x, y, z\}.\]</div>
<p>Systems with singificantly anisotropic <span class="math notranslate nohighlight">\(g\)</span>-tensors violate the angular momentum
commutation relations:</p>
<div class="math notranslate nohighlight">
\[[G_x, G_y] = i g \mu_B G_z,\]</div>
<p>which are essential for the validity of the rotating-frame transformation.</p>
<p>In general, we recomend use RWA only for isotropic case. For the anisotropic case it is better to use propagator computation.</p>
</section>
<section id="circular-polarization">
<h3>Circular Polarization<a class="headerlink" href="#circular-polarization" title="Link to this heading"></a></h3>
<p>The oscillating magnetic field must be circularly polarized:</p>
<div class="math notranslate nohighlight">
\[B_1(t) = B_1[\cos(\omega t)\hat{x} + \sin(\omega t)\hat{y}]\]</div>
<p>Linear polarization introduces counter-rotating components that are not eliminated by RWA.</p>
<p><strong>Why this occurs</strong>: Linear polarization contains both co-rotating and counter-rotating components. The RWA discards the counter-rotating terms, which is valid only when they oscillate at ~2ω and can be neglected.</p>
</section>
<section id="commutation-with-zero-field-hamiltonian">
<h3>Commutation with Zero-Field Hamiltonian<a class="headerlink" href="#commutation-with-zero-field-hamiltonian" title="Link to this heading"></a></h3>
<p>The zero-field part of the Hamiltonian must commute with S_z (or G_z):</p>
<div class="math notranslate nohighlight">
\[[F, S_z] = 0\]</div>
<p>The rotating frame transformation exp(iωS_z t) must leave F invariant. If F does not commute with S_z, additional time-dependent terms appear that cannot be eliminated.</p>
<p>This is automatically satisfied for:</p>
<ul class="simple">
<li><p>Isotropic exchange interactions</p></li>
</ul>
<p>This is violated for:</p>
<ul class="simple">
<li><p>Non-axial zero-field splitting with arbitrary orientation</p></li>
<li><p>Anisotropic exchange or dipolar interactions not aligned with the field</p></li>
</ul>
</section>
<section id="relaxation-superoperator-structure">
<h3>Relaxation Superoperator Structure<a class="headerlink" href="#relaxation-superoperator-structure" title="Link to this heading"></a></h3>
<p>The relaxation superoperator $R_{ijkl}$ (coupling density matrix elements $ρ_{ij}$ and $ρ_{kl}$) must satisfy:</p>
<div class="math notranslate nohighlight">
\[R_{ijkl} \neq 0 \quad \text{only if} \quad i - j = k - l\]</div>
<p>This constraint arises because the rotating frame transformation requires R to commute with S_z in Liouville space.</p>
<p><strong>Allowed processes</strong>:</p>
<ul class="simple">
<li><p>Population transfer: i = j, k = l (including pure decay i = j = k = l)</p></li>
<li><p>Dephasing of coherences: i = k, j = l</p></li>
</ul>
<p><strong>Forbidden processes</strong>:</p>
<ul class="simple">
<li><p>Coherence-population coupling: mixing off-diagonal and diagonal density matrix elements with i - j ≠ k - l</p></li>
</ul>
</section>
</section>
<section id="powder-averaging">
<h2>Powder Averaging<a class="headerlink" href="#powder-averaging" title="Link to this heading"></a></h2>
<p>For disordered samples, spectra are averaged over molecular orientations (α, β).
Since the RWA assumes an close-to-isotropic g-factor, the γ Euler angle does not affect resonance frequencies</p>
</section>
<section id="applicability">
<h2>Applicability<a class="headerlink" href="#applicability" title="Link to this heading"></a></h2>
<p>The RWA is suitable for:</p>
<ul class="simple">
<li><p>Organic radicals with isotropic g-factors</p></li>
<li><p>Triplet states with small axial zero-field splitting aligned with the field</p></li>
<li><p>Systems where coherence-population coupling is negligible</p></li>
</ul>
<p>The RWA should <strong>not</strong> be used for:</p>
<ul class="simple">
<li><p>Transition metal complexes with anisotropic g-tensors</p></li>
<li><p>Systems with strong non-secular relaxation</p></li>
<li><p>Single-molecule magnets with large zero-field splittings</p></li>
<li><p>High-field EPR where g-anisotropy is resolved</p></li>
</ul>
<p>For such systems, use the propagator-based approach which imposes no similar approximations.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="level_based_kynetic.html" class="btn btn-neutral float-left" title="Level-Based Kinetic Approach" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="propagator_computation.html" class="btn btn-neutral float-right" title="Propagator-Based Density Matrix Evolution" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, Arkady Samsonenko, Ivan Kurgansky.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>