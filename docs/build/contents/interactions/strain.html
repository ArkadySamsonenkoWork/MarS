

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Strain in MarS &mdash; MarS 2026.01.11 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=7e9183e1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Population Computation" href="../populators/index.html" />
    <link rel="prev" title="Frame, Rotations and Euler Angles" href="frame.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            MarS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quick Start</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../base_spin_system.html">Base Spin System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sample.html">Sample Representation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spectrum_constraction.html">EPR Spectrum Construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fitting_tutorial.html">Fitting Spectroscopic Data</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Interactions in MarS</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="interaction.html">Interaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="deinteraction.html">DEInteraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="frame.html">Frame, Rotations and Euler Angles</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Strain in MarS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#strain-vs-explicit-modeling">Strain vs. Explicit Modeling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-strain-works">How Strain Works</a></li>
<li class="toctree-l3"><a class="reference internal" href="#specifying-strain">Specifying Strain</a></li>
<li class="toctree-l3"><a class="reference internal" href="#important-notes">Important Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-strain-correlations">Custom Strain Correlations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#physical-motivation">Physical Motivation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mathematical-framework">Mathematical Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="#implementation-in-mars">Implementation in MarS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-1-uncorrelated-g-strains">Example 1: Uncorrelated g-strains</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-2-fully-correlated-g-strains">Example 2: Fully correlated g-strains</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../populators/index.html">Population Computation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../context/index.html">Relaxation Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spectra_creators/index.html">Spectra Creators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intensity_calculators/index.html">Transition Intensity Calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../meshers/index.html">Meshing Strategies</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/mars.html">mars package</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorial Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples/example_1.html">Continuous-Wave EPR Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/example_2.html">Polarized Radiation EPR Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/example_3.html">Fitting Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/example_4.html">Advance Fitting Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/example_5.html">Spectra Polarization and Time Resolved</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/example_6.html">Multi-System Kinetic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/example_7.html">Time-Resolved Fitting Procedures</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Info</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/ArkadySamsonenkoWork/MarS.git"> GitHub Repository</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MarS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Interactions in MarS</a></li>
      <li class="breadcrumb-item active">Strain in MarS</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/contents/interactions/strain.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="strain-in-mars">
<span id="strain-management-mars"></span><h1>Strain in MarS<a class="headerlink" href="#strain-in-mars" title="Link to this heading"></a></h1>
<p>“Strain” in MarS refers to the <em>distribution of spin Hamiltonian parameters</em> due to structural disorder (e.g., in frozen solutions, powders, or amorphous matrices). This leads to inhomogeneous broadening of EPR lines.</p>
<p>Strain is specified in MarS as the full width at half maximum (FWHM) of the parameter distribution and is expressed in the natural units of the corresponding Hamiltonian parameter (dimensionless for the g-tensor, Hz for zero-field splitting).</p>
<section id="strain-vs-explicit-modeling">
<h2>Strain vs. Explicit Modeling<a class="headerlink" href="#strain-vs-explicit-modeling" title="Link to this heading"></a></h2>
<p>To understand strain modeling, consider two approaches to simulate disorder in a sample:</p>
<p><strong>Explicit Modeling (Monte Carlo)</strong></p>
<p>In explicit modeling, you would generate many spin systems with different parameter values drawn from a distribution, compute the spectrum for each, and average:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mars</span><span class="w"> </span><span class="kn">import</span> <span class="n">spin_model</span>

<span class="c1"># Generate 1000 samples from a Gaussian distribution</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">g_mean</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">2.002</span><span class="p">,</span> <span class="mf">2.004</span><span class="p">,</span> <span class="mf">2.008</span><span class="p">])</span>
<span class="n">g_std</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>  <span class="c1"># to convert σ into FWHM</span>

<span class="c1"># Sample g-values from Gaussian distribution</span>
<span class="n">g_samples</span> <span class="o">=</span> <span class="n">g_mean</span> <span class="o">+</span> <span class="n">g_std</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># Create 1000 different spin systems</span>
<span class="n">interactions</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_samples</span><span class="p">):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">spin_model</span><span class="o">.</span><span class="n">Interaction</span><span class="p">(</span><span class="n">g_samples</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">interactions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

<span class="c1"># Compute spectrum for each and average</span>
</pre></div>
</div>
<p><strong>Strain Modeling (Analytical)</strong></p>
<p>Strain modeling achieves the same result analytically using second-order perturbation theory, avoiding the need to sample many configurations:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mars</span><span class="w"> </span><span class="kn">import</span> <span class="n">spin_model</span>

<span class="c1"># Single spin system with strain parameters</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">spin_model</span><span class="o">.</span><span class="n">Interaction</span><span class="p">(</span>
    <span class="n">components</span><span class="o">=</span><span class="p">(</span><span class="mf">2.002</span><span class="p">,</span> <span class="mf">2.004</span><span class="p">,</span> <span class="mf">2.008</span><span class="p">),</span>
    <span class="n">strain</span><span class="o">=</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">)</span>  <span class="c1"># FWHM of distributions</span>
<span class="p">)</span>

<span class="c1"># Compute broadening analytically</span>
</pre></div>
</div>
<p>In strain modeling, MarS computes how parameter variations affect transition energies through derivatives of the Hamiltonian matrix elements. For a transition between states <span class="math notranslate nohighlight">\(|u\rangle\)</span> and <span class="math notranslate nohighlight">\(|v\rangle\)</span>, the linewidth contribution is:</p>
<div class="math notranslate nohighlight">
\[\Delta\nu_{uv} \propto \sum_{i=x,y,z} \left( \frac{\partial H_{uv}}{\partial g_i} \right)^2 \sigma_i^2\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma_i\)</span> is the standard deviation of the <span class="math notranslate nohighlight">\(i\)</span>-th parameter (related to FWHM by <span class="math notranslate nohighlight">\(\sigma = \text{FWHM} / (2\sqrt{2\ln 2})\)</span>).</p>
<p>This approach is equivalent to Monte Carlo sampling in the limit of small strain, but requires only a single computation.</p>
</section>
<section id="how-strain-works">
<h2>How Strain Works<a class="headerlink" href="#how-strain-works" title="Link to this heading"></a></h2>
<p>For any interaction, strain is modeled as a Gaussian distribution of the principal values. In the case of <code class="xref py py-class docutils literal notranslate"><span class="pre">mars.spin_model.Interaction</span></code>, strain is applied independently to <span class="math notranslate nohighlight">\(T_x, T_y, T_z\)</span>. For <code class="xref py py-class docutils literal notranslate"><span class="pre">mars.spin_model.DEInteraction</span></code>, strain is applied to the underlying <span class="math notranslate nohighlight">\(D\)</span> and <span class="math notranslate nohighlight">\(E\)</span> parameters.</p>
<p>During simulation, MarS integrates over this distribution analytically (via second-order perturbation theory) when computing the spectrum, avoiding costly Monte Carlo sampling. The result is a broadened lineshape consistent with Gaussian disorder in the Hamiltonian parameters.</p>
</section>
<section id="specifying-strain">
<h2>Specifying Strain<a class="headerlink" href="#specifying-strain" title="Link to this heading"></a></h2>
<p>Strain is passed as a vector with the same length as the components:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Isotropic g-strain</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">Interaction</span><span class="p">(</span><span class="mf">2.0023</span><span class="p">,</span> <span class="n">strain</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>

<span class="c1"># Anisotropic g-strain</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">Interaction</span><span class="p">((</span><span class="mf">2.02</span><span class="p">,</span> <span class="mf">2.04</span><span class="p">,</span> <span class="mf">2.06</span><span class="p">),</span> <span class="n">strain</span><span class="o">=</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">))</span>

<span class="c1"># ZFS strain on D and E</span>
<span class="n">zfs</span> <span class="o">=</span> <span class="n">DEInteraction</span><span class="p">([</span><span class="mf">500e6</span><span class="p">,</span> <span class="mf">100e6</span><span class="p">],</span> <span class="n">strain</span><span class="o">=</span><span class="p">[</span><span class="mf">50e6</span><span class="p">,</span> <span class="mf">10e6</span><span class="p">])</span>
</pre></div>
</div>
<p>Units must match those of the components (e.g., Hz for couplings, dimensionless for g).</p>
</section>
<section id="important-notes">
<h2>Important Notes<a class="headerlink" href="#important-notes" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Strain in MarS is <strong>uncorrelated by default</strong> for <code class="xref py py-class docutils literal notranslate"><span class="pre">mars.spin_model.Interaction</span></code> (diagonal covariance).</p></li>
<li><p>Strain distributions are assumed Gaussian and static.</p></li>
<li><p>MarS allows you to set any type of correlation within a single interaction using the <code class="xref py py-meth docutils literal notranslate"><span class="pre">set_strain()</span></code> method: <code class="docutils literal notranslate"><span class="pre">interaction.set_strain(new_strain,</span> <span class="pre">new_correlation_matrix)</span></code></p></li>
</ul>
</section>
<section id="custom-strain-correlations">
<h2>Custom Strain Correlations<a class="headerlink" href="#custom-strain-correlations" title="Link to this heading"></a></h2>
<p>MarS allows you to define arbitrary linear correlations between the underlying physical parameters and the tensor components via the <code class="docutils literal notranslate"><span class="pre">strain_correlation</span></code> attribute.</p>
<section id="physical-motivation">
<h3>Physical Motivation<a class="headerlink" href="#physical-motivation" title="Link to this heading"></a></h3>
<p>Suppose you model a system where g-strain arises from two independent structural modes:</p>
<ul class="simple">
<li><p>A <strong>symmetric compression</strong> affecting all axes equally (isotropic shift)</p></li>
<li><p>A <strong>tetragonal distortion</strong> affecting only <span class="math notranslate nohighlight">\(g_z\)</span></p></li>
</ul>
<p>You can represent this with two strain parameters <span class="math notranslate nohighlight">\(\delta s\)</span> (symmetric) and <span class="math notranslate nohighlight">\(\delta t\)</span> (tetragonal), leading to:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
\delta g_x \\ \delta g_y \\ \delta g_z
\end{bmatrix}
=
\begin{bmatrix}
1 &amp; 0 \\
1 &amp; 0 \\
1 &amp; 1
\end{bmatrix}
\begin{bmatrix}
\delta s \\ \delta t
\end{bmatrix}\end{split}\]</div>
</section>
<section id="mathematical-framework">
<h3>Mathematical Framework<a class="headerlink" href="#mathematical-framework" title="Link to this heading"></a></h3>
<p>In MarS, the strain broadening is computed from the derivatives of the Hamiltonian matrix elements <span class="math notranslate nohighlight">\(H_{uv}\)</span> with respect to the physical parameters. For a transition between states <span class="math notranslate nohighlight">\(|u\rangle\)</span> and <span class="math notranslate nohighlight">\(|v\rangle\)</span>, the field-dependent contribution to the linewidth is proportional to:</p>
<div class="math notranslate nohighlight">
\[\sum_{\alpha=s,t} \left( \frac{\partial H_{uv}}{\partial p_\alpha} \right)^2 \sigma_\alpha^2
=
\sum_{\alpha=s,t} \left( \sum_{i=x,y,z} \frac{\partial H_{uv}}{\partial g_i} \frac{\partial g_i}{\partial p_\alpha} \right)^2 \sigma_\alpha^2\]</div>
<p>where <span class="math notranslate nohighlight">\(p_\alpha = [s, t]\)</span>, and the Jacobian <span class="math notranslate nohighlight">\(\partial g_i / \partial p_\alpha\)</span> is provided by the <code class="docutils literal notranslate"><span class="pre">strain_correlation</span></code> matrix.</p>
</section>
<section id="implementation-in-mars">
<h3>Implementation in MarS<a class="headerlink" href="#implementation-in-mars" title="Link to this heading"></a></h3>
<p>In MarS, this is implemented as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mars</span><span class="w"> </span><span class="kn">import</span> <span class="n">spin_model</span>

<span class="c1"># Define base g-tensor</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">spin_model</span><span class="o">.</span><span class="n">Interaction</span><span class="p">(</span>
    <span class="n">components</span><span class="o">=</span><span class="p">(</span><span class="mf">2.002</span><span class="p">,</span> <span class="mf">2.004</span><span class="p">,</span> <span class="mf">2.008</span><span class="p">),</span>
    <span class="n">strain</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">])</span>  <span class="c1"># Two strain parameters: σ_s, σ_t</span>
<span class="p">)</span>

<span class="c1"># Set custom correlation matrix C = ∂g_i / ∂p_α (shape: 3 × 2)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span>
    <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>  <span class="c1"># ∂g_x/∂s = 1, ∂g_x/∂t = 0</span>
    <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>  <span class="c1"># ∂g_y/∂s = 1, ∂g_y/∂t = 0</span>
    <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>   <span class="c1"># ∂g_z/∂s = 1, ∂g_z/∂t = 1</span>
<span class="p">])</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_strain</span><span class="p">(</span><span class="n">strain</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">]),</span> <span class="n">correlation_matrix</span><span class="o">=</span><span class="n">C</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h2>
<section id="example-1-uncorrelated-g-strains">
<h3>Example 1: Uncorrelated g-strains<a class="headerlink" href="#example-1-uncorrelated-g-strains" title="Link to this heading"></a></h3>
<p>When g-tensor components vary independently (default behavior):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mars</span><span class="w"> </span><span class="kn">import</span> <span class="n">spin_model</span>

<span class="c1"># Three independent Gaussian distributions for gx, gy, gz</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">spin_model</span><span class="o">.</span><span class="n">Interaction</span><span class="p">(</span>
    <span class="n">components</span><span class="o">=</span><span class="p">(</span><span class="mf">2.002</span><span class="p">,</span> <span class="mf">2.004</span><span class="p">,</span> <span class="mf">2.008</span><span class="p">),</span>
    <span class="n">strain</span><span class="o">=</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Correlation matrix is identity (3×3):</span>
<span class="c1"># [[1, 0, 0],</span>
<span class="c1">#  [0, 1, 0],</span>
<span class="c1">#  [0, 0, 1]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">strain_correlation</span><span class="p">)</span>
</pre></div>
</div>
<p>This represents three independent strain sources, each affecting only one principal axis.</p>
</section>
<section id="example-2-fully-correlated-g-strains">
<h3>Example 2: Fully correlated g-strains<a class="headerlink" href="#example-2-fully-correlated-g-strains" title="Link to this heading"></a></h3>
<p>When all g-tensor components shift together (isotropic strain):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mars</span><span class="w"> </span><span class="kn">import</span> <span class="n">spin_model</span>

<span class="c1"># Single strain parameter affects all components equally</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">spin_model</span><span class="o">.</span><span class="n">Interaction</span><span class="p">(</span>
    <span class="n">components</span><span class="o">=</span><span class="p">(</span><span class="mf">2.002</span><span class="p">,</span> <span class="mf">2.004</span><span class="p">,</span> <span class="mf">2.008</span><span class="p">)</span>
<span class="p">)</span>  <span class="c1"># None strain parameter</span>

<span class="c1"># Correlation matrix (3×1):</span>
<span class="c1"># [[1],</span>
<span class="c1">#  [1],</span>
<span class="c1">#  [1]]</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]])</span>
<span class="n">g</span><span class="o">.</span><span class="n">set_strain</span><span class="p">(</span><span class="n">strain</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.001</span><span class="p">]),</span> <span class="n">correlation_matrix</span><span class="o">=</span><span class="n">C</span><span class="p">)</span>  <span class="c1"># Set the necessary strain here</span>
</pre></div>
</div>
<p>This means:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
\delta g_x \\ \delta g_y \\ \delta g_z
\end{bmatrix}
=
\begin{bmatrix}
1 \\ 1 \\ 1
\end{bmatrix}
\delta s\end{split}\]</div>
<p>All components fluctuate together with the same magnitude.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="frame.html" class="btn btn-neutral float-left" title="Frame, Rotations and Euler Angles" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../populators/index.html" class="btn btn-neutral float-right" title="Population Computation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, Arkady Samsonenko, Ivan Kurgansky.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>