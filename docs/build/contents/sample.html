

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sample Representation &mdash; MarS 2026.01.11 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=7e9183e1"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="EPR Spectrum Construction" href="spectrum_constraction.html" />
    <link rel="prev" title="Base Spin System" href="base_spin_system.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            MarS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick Start</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="base_spin_system.html">Base Spin System</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Sample Representation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hamiltonian-terms">Hamiltonian Terms</a></li>
<li class="toctree-l2"><a class="reference internal" href="#useful-features">Useful Features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basis-methods">Basis Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="#concatenating-samples">Concatenating Samples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#usage">Usage</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="spectrum_constraction.html">EPR Spectrum Construction</a></li>
<li class="toctree-l1"><a class="reference internal" href="fitting_tutorial.html">Fitting Spectroscopic Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="interactions/index.html">Interactions in MarS</a></li>
<li class="toctree-l1"><a class="reference internal" href="populators/index.html">Population Computation</a></li>
<li class="toctree-l1"><a class="reference internal" href="context/index.html">Relaxation Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="spectra_creators/index.html">Spectra Creators</a></li>
<li class="toctree-l1"><a class="reference internal" href="intensity_calculators/index.html">Transition Intensity Calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="meshers/index.html">Meshing Strategies</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/mars.html">mars package</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorial Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/example_1.html">Continuous-Wave EPR Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/example_2.html">Polarized Radiation EPR Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/example_3.html">Fitting Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/example_4.html">Advance Fitting Procedures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/example_5.html">Spectra Polarization and Time Resolved</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/example_6.html">Multi-System Kinetic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/example_7.html">Time-Resolved Fitting Procedures</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Info</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/ArkadySamsonenkoWork/MarS.git"> GitHub Repository</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MarS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Sample Representation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/contents/sample.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="sample-representation">
<h1>Sample Representation<a class="headerlink" href="#sample-representation" title="Link to this heading"></a></h1>
<p>In EPR modeling, a <em>sample</em> extends a base spin system with broadening mechanisms (Gaussian/Lorentzian), unresolved strain, for powders-orientational averaging.</p>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h2>
<p><strong>1. Powder spectrum of a triplet with axial ZFS</strong></p>
<p>Simulate a frozen solution of a diradical with D = 0.35 GHz, E = 0, using a default mesh:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mars</span><span class="w"> </span><span class="kn">import</span> <span class="n">spin_model</span><span class="o">.</span> <span class="n">particles</span>

<span class="n">g_tensor</span> <span class="o">=</span> <span class="n">spin_model</span><span class="o">.</span><span class="n">Interaction</span><span class="p">(</span><span class="mf">2.002</span><span class="p">)</span>  <span class="c1"># g = 2.002</span>
<span class="n">D_tensor</span> <span class="o">=</span> <span class="n">spin_model</span><span class="o">.</span><span class="n">DEInteraction</span><span class="p">(</span><span class="n">components</span><span class="o">=</span><span class="mf">0.35</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">)</span>  <span class="c1"># D = 0.35 GHz</span>
<span class="n">triplet</span> <span class="o">=</span> <span class="n">spin_model</span><span class="o">.</span><span class="n">SpinSystem</span><span class="p">(</span><span class="n">electrons</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">],</span> <span class="n">g_tensors</span><span class="o">=</span><span class="p">[</span><span class="n">g_tensor</span><span class="p">],</span> <span class="n">electron_electron</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">D_tensor</span><span class="p">)])</span>

<span class="n">sample</span> <span class="o">=</span> <span class="n">spin_model</span><span class="o">.</span><span class="n">MultiOrientedSample</span><span class="p">(</span><span class="n">base_spin_system</span><span class="o">=</span><span class="n">triplet</span><span class="p">,</span> <span class="n">gauss</span><span class="o">=</span><span class="s2">&quot;0.01&quot;</span><span class="p">)</span> <span class="c1"># It is better to specify some broadening</span>
</pre></div>
</div>
<p>The total broadening of each spectral line is constructed from four components:</p>
<ol class="arabic simple">
<li><p><strong>Homogeneous Lorentzian broadening</strong>, which is applied after the spectrum is constructed.</p></li>
<li><p><strong>Inhomogeneous Gaussian broadening</strong>, which is applied after the spectrum is constructed.
More information about final spectrum postprocessing can be found in <code class="xref py py-class docutils literal notranslate"><span class="pre">mars.spectra_manager.spectra_manager.PostSpectraProcessing</span></code>.</p></li>
<li><p><strong>Residual spectrum broadening</strong> caused by unresolved interactions. This is specified by a parameter <code class="docutils literal notranslate"><span class="pre">ham_strain</span></code> and can be anisotropic.</p></li>
<li><p><strong>Broadening caused by the presence of a Hamiltonian parameter distribution</strong>. This parameters is specified during <code class="xref py py-class docutils literal notranslate"><span class="pre">mars.spin_model.Interaction</span></code> creation.</p></li>
</ol>
<p>All widths are specified as full width at half maximum (FWHM).</p>
<p><strong>2. Anisotropic Gaussian broadening</strong></p>
<p>Add orientation-dependent inhomogeneous broadening due to unresolved hyperfine structure:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Axial unresolved broadening: σ⊥ = 5 MHz, σ∥ = 15 MHz</span>
<span class="n">ham_strain</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5e-3</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">5e-3</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mf">15e-3</span> <span class="o">*</span> <span class="mf">1e9</span><span class="p">]</span>

<span class="n">sample</span> <span class="o">=</span> <span class="n">spin_model</span><span class="o">.</span><span class="n">MultiOrientedSample</span><span class="p">(</span>
    <span class="n">base_spin_system</span><span class="o">=</span><span class="n">triplet</span><span class="p">,</span>
    <span class="n">ham_strain</span><span class="o">=</span><span class="n">ham_strain</span><span class="p">,</span>
    <span class="n">lorentz</span><span class="o">=</span><span class="mf">0.001</span>  <span class="c1"># 1 mT homogeneous width</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>3. Custom orientation mesh</strong></p>
<p>In MarS it is possible to modify mesh to increse resolution of increase speed. Also it is possible to set a custom mesh (see <a class="reference internal" href="meshers/index.html#orientational-mesh"><span class="std std-ref">Meshing Strategies</span></a>)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use only 80 orientations instead of default ~ 200</span>
<span class="n">coarse_mesh</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>  <span class="c1"># (initial_grid_frequency, interpolation_grid_frequency)</span>

<span class="n">fast_sample</span> <span class="o">=</span> <span class="n">spin_model</span><span class="o">.</span><span class="n">MultiOrientedSample</span><span class="p">(</span>
    <span class="n">base_spin_system</span><span class="o">=</span><span class="n">triplet</span><span class="p">,</span>
    <span class="n">mesh</span><span class="o">=</span><span class="n">coarse_mesh</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>4. Sample spin system orientation</strong></p>
<p>In some cases, it’s convenient to rotate not just one interaction, but all interactions at once (rotate the entire spin system relative laboratory frame).
This doesn’t change the final spectrum of the sample, but it can be convinient for creation of complex systems.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rotated_sample</span> <span class="o">=</span> <span class="n">spin_model</span><span class="o">.</span><span class="n">MultiOrientedSample</span><span class="p">(</span>
    <span class="n">base_spin_system</span><span class="o">=</span><span class="n">triplet</span><span class="p">,</span>
    <span class="n">spin_system_frame</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="hamiltonian-terms">
<h2>Hamiltonian Terms<a class="headerlink" href="#hamiltonian-terms" title="Link to this heading"></a></h2>
<p>The total spin Hamiltonian in the presence of a magnetic field <strong>B</strong> = (B_x, B_y, B_z) is expressed as:</p>
<div class="math notranslate nohighlight">
\[\mathcal{H}(\mathbf{B}) = F + B_x G_x + B_y G_y + B_z G_z\]</div>
<p>where:</p>
<ul class="simple">
<li><p><strong>F</strong> is the field-independent (zero-field) part of the Hamiltonian,</p></li>
<li><p><strong>G_z</strong>, <strong>G_y</strong>, <strong>G_z</strong> are the Zeeman coupling operators that encode the system’s response to the external magnetic field via electron and nuclear g‑tensors.</p></li>
</ul>
<p>Explicitly, these operators are defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
G_x &amp;= \frac{\mu_\mathrm{B}}{h} \sum_{i} \left( g_{i,xx} \hat{S}_i^{(x)} + g_{i,xy} \hat{S}_i^{(y)} + g_{i,xz} \hat{S}_i^{(z)} \right)
      + \frac{\mu_\mathrm{N}}{h} \sum_{j} g_{n,j} \hat{I}_j^{(x)}, \\
G_y &amp;= \frac{\mu_\mathrm{B}}{h} \sum_{i} \left( g_{i,yx} \hat{S}_i^{(x)} + g_{i,yy} \hat{S}_i^{(y)} + g_{i,yz} \hat{S}_i^{(z)} \right)
      + \frac{\mu_\mathrm{N}}{h} \sum_{j} g_{n,j} \hat{I}_j^{(y)}, \\
G_z &amp;= \frac{\mu_\mathrm{B}}{h} \sum_{i} \left( g_{i,zx} \hat{S}_i^{(x)} + g_{i,zy} \hat{S}_i^{(y)} + g_{i,zz} \hat{S}_i^{(z)} \right)
      + \frac{\mu_\mathrm{N}}{h} \sum_{j} g_{n,j} \hat{I}_j^{(z)},
\end{aligned}\end{split}\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\hat{S}_i^{(x,y,z)}\)</span> are the electron spin operators for electron <span class="math notranslate nohighlight">\(i\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\hat{I}_j^{(x,y,z)}\)</span> are the nuclear spin operators for nucleus <span class="math notranslate nohighlight">\(j\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{g}_i\)</span> is the (possibly anisotropic) electron g‑tensor for electron <span class="math notranslate nohighlight">\(i\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(g_{n,j}\)</span> is the (currently isotropic) nuclear g‑factor for nucleus <span class="math notranslate nohighlight">\(j\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\mu_\mathrm{B}\)</span> is the Bohr magneton,</p></li>
<li><p><span class="math notranslate nohighlight">\(\mu_\mathrm{N}\)</span> is the nuclear magneton,</p></li>
<li><p><span class="math notranslate nohighlight">\(h\)</span> is Planck’s constant.</p></li>
</ul>
<p>These operators act on the full product-state Hilbert space and are returned by the sample methods as complex-valued tensors.</p>
<p>You can retrieve them directly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Full Hamiltonian decomposition</span>
<span class="n">F</span><span class="p">,</span> <span class="n">Gx</span><span class="p">,</span> <span class="n">Gy</span><span class="p">,</span> <span class="n">Gz</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">get_hamiltonian_terms</span><span class="p">()</span>

<span class="c1"># Secular approximation: only retain elements of F that commute with Gz.</span>
<span class="c1">#   1. Zero non-commuting elements in Zeeman terms (Gx/Gy/Gz) with respect to spin projections, making Gx,y,z[Sx,y,z == 0] = 0</span>
<span class="c1">#   2. Zero non-commuting elements in F with respect to Gz, making F[Gz == 0] = 0</span>
<span class="n">F_sec</span><span class="p">,</span> <span class="n">Gx</span><span class="p">,</span> <span class="n">Gy</span><span class="p">,</span> <span class="n">Gz</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">get_hamiltonian_terms_secular</span><span class="p">()</span>
</pre></div>
</div>
<p>The secular approximation modifies the Hamiltonian terms in two steps:</p>
<ol class="arabic">
<li><p>Zeeman term modification
For each component <span class="math notranslate nohighlight">\(\alpha \in \{x, y, z\}\)</span>, matrix elements of <span class="math notranslate nohighlight">\(G_\alpha\)</span> are zeroed where the corresponding spin projection operator <span class="math notranslate nohighlight">\(S_\alpha\)</span> has negligible magnitude:</p>
<div class="math notranslate nohighlight">
\[\begin{split}(G_\alpha)_{ij} \leftarrow
\begin{cases}
(G_\alpha)_{ij} &amp; \text{if } |(S_\alpha)_{ij}| &gt; \varepsilon \\
0 &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<p>This enforces approximate commutation <span class="math notranslate nohighlight">\([G_\alpha, S_\alpha] \approx 0\)</span>. For single spins with isotropic g-tensors this is exact. For anisotropic cases it retains only the diagonal part of the g-tensor.</p>
</li>
<li><p>Zero-field term modification
Matrix elements of <span class="math notranslate nohighlight">\(F\)</span> are zeroed where diagonal elements of <span class="math notranslate nohighlight">\(G_z\)</span> differ:</p>
<div class="math notranslate nohighlight">
\[\begin{split}F_{ij}^{\text{sec}} =
\begin{cases}
  F_{ij}, &amp; \text{if } |(G_z)_{ii} - (G_z)_{jj}| &lt; \varepsilon \\
  0,      &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<p>This enforces <span class="math notranslate nohighlight">\([F^{\text{sec}}, G_z] \approx 0\)</span> with threshold <span class="math notranslate nohighlight">\(\varepsilon\)</span> (default: <span class="math notranslate nohighlight">\(10^{-9}\)</span>).</p>
</li>
</ol>
</section>
<section id="useful-features">
<h2>Useful Features<a class="headerlink" href="#useful-features" title="Link to this heading"></a></h2>
<p><code class="xref py py-class docutils literal notranslate"><span class="pre">mars.spin_model.BaseSample</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">mars.spin_model.MultiOrientedSample</span></code> provide several utility methods for advanced quantum-mechanical analysis, including access to key spin operators and basis transformations.
These are especially useful when working with total spin manifolds or custom spectral models.</p>
<section id="basis-methods">
<h3>Basis Methods<a class="headerlink" href="#basis-methods" title="Link to this heading"></a></h3>
<p>The following methods allow you to construct and switch between common representations of the spin Hilbert space:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Mul</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">get_spin_multiplet_basis</span><span class="p">()</span>      <span class="c1"># |S, M&gt; basis (eigenbasis of S^2 and S_z)</span>
<span class="n">PR</span>  <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">get_product_state_basis</span><span class="p">()</span>       <span class="c1"># Computational |m1, m2, ...&gt; basis</span>
</pre></div>
</div>
<ul>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">mars.spin_model.MultiOrientedSample.get_spin_multiplet_basis()</span></code>
Constructs a unitary transformation matrix that converts from the product-state basis to the total-spin multiplet basis <span class="math notranslate nohighlight">\(|S, M\rangle\)</span>.</p>
<ul class="simple">
<li><p><strong>Output</strong>: A matrix whose columns are eigenvectors of <span class="math notranslate nohighlight">\(\hat{S}^2\)</span> and <span class="math notranslate nohighlight">\(\hat{S}_z\)</span>, sorted first by <span class="math notranslate nohighlight">\(S\)</span>, then by <span class="math notranslate nohighlight">\(M\)</span>.</p></li>
<li><p><strong>Ordering</strong>: States are arranged in ascending order of total spin <span class="math notranslate nohighlight">\(S\)</span>, and within each <span class="math notranslate nohighlight">\(S\)</span> manifold, by increasing <span class="math notranslate nohighlight">\(M\)</span>.</p></li>
<li><p><strong>Example</strong>: For two spin-½ electrons, the basis order is
<span class="math notranslate nohighlight">\(|S=0, M=0\rangle,\ |S=1, M=-1\rangle,\ |S=1, M=0\rangle,\ |S=1, M=+1\rangle\)</span>.</p></li>
</ul>
</li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">mars.spin_model.MultiOrientedSample.get_product_state_basis()</span></code>
Returns the identity matrix, confirming that internal operators are represented in the standard product-state basis:</p>
<div class="math notranslate nohighlight">
\[|\psi\rangle = |m_{e_1}, m_{e_2}, \dots, m_{n_1}, m_{n_2}, \dots\rangle\]</div>
<ul class="simple">
<li><p><strong>Shape</strong>: <code class="docutils literal notranslate"><span class="pre">(spin_dim,</span> <span class="pre">spin_dim)</span></code></p></li>
</ul>
</li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">mars.spin_model.MultiOrientedSample.get_xyz_basis()</span></code>
Returns the transition moment basis vectors <span class="math notranslate nohighlight">\(T_x\)</span>, <span class="math notranslate nohighlight">\(T_y\)</span>, <span class="math notranslate nohighlight">\(T_z\)</span> for a spin-1 system expressed in the molecular frame.</p>
<p>The basis is defined in the <span class="math notranslate nohighlight">\(|M_z = +1\rangle\)</span>, <span class="math notranslate nohighlight">\(|M_z = 0\rangle\)</span>, <span class="math notranslate nohighlight">\(|M_z = -1\rangle\)</span> eigenbasis of <span class="math notranslate nohighlight">\(\hat{S}_z\)</span>.</p>
<ul>
<li><p><strong>Return</strong>: A tensor of shape <code class="docutils literal notranslate"><span class="pre">[...,</span> <span class="pre">orientations,</span> <span class="pre">3,</span> <span class="pre">3]</span></code>, where the last two dimensions correspond to the three Cartesian components (<span class="math notranslate nohighlight">\(x, y, z\)</span>) and the three <span class="math notranslate nohighlight">\(M_z\)</span> states.</p></li>
<li><p><strong>Example</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_xyz_basis</span><span class="p">()</span>   <span class="c1"># shape: [..., orientations, 3, 3]</span>
<span class="n">Tx</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>               <span class="c1"># x-component, shape: [..., orientations, 3]</span>
<span class="n">Ty</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>               <span class="c1"># y-component, shape: [..., orientations, 3]</span>
<span class="n">Tz</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>               <span class="c1"># z-component, shape: [..., orientations, 3]</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">mars.spin_model.MultiOrientedSample.get_zero_field_splitting_basis()</span></code>
Returns the eigenbasis of the zero-field splitting (ZFS) Hamiltonian, denoted as <span class="math notranslate nohighlight">\(\mathbf{F}\)</span>.</p>
<p>The eigenvectors are ordered from the lowest to the highest eigenvalue of <span class="math notranslate nohighlight">\(\mathbf{F}\)</span>.</p>
<ul class="simple">
<li><p><strong>Return</strong>: A tensor of shape <code class="docutils literal notranslate"><span class="pre">[...,</span> <span class="pre">N,</span> <span class="pre">N]</span></code>, where <span class="math notranslate nohighlight">\(N\)</span> is the spin Hilbert space dimension.</p></li>
</ul>
</li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">mars.spin_model.MultiOrientedSample.get_zeeman_basis()</span></code>
Returns the eigenbasis of the Zeeman operator <span class="math notranslate nohighlight">\(\mathbf{G}_z\)</span>, corresponding to the infinite magnetic field limit along the laboratory z-axis.</p>
<p>The eigenvectors are ordered from the lowest to the highest eigenvalue of  <span class="math notranslate nohighlight">\(\mathbf{G}_z\)</span>.
- <strong>Return</strong>: A tensor of shape […, N, N], where :math:N is the spin Hilbert space dimension.</p>
</li>
</ul>
</section>
<section id="concatenating-samples">
<h3>Concatenating Samples<a class="headerlink" href="#concatenating-samples" title="Link to this heading"></a></h3>
<p>MarS allows concatenation of multiple <code class="xref py py-class docutils literal notranslate"><span class="pre">mars.spin_model.MultiOrientedSample</span></code> objects into a single composite samples using the direct sum construction of their spin systems</p>
<p>This is not equivalent to building a true multi-particle quantum system (which would require a tensor-product Hilbert space). Instead, it creates a block-diagonal representation suitable for specific effective models.</p>
<p>Use concatenation only in scenarios such as:</p>
<p>-Modeling an electron that may occupy distinct spin environments (e.g., two triplet states with slightly different zero-field splitting or dipolar couplings).</p>
<p>-Simulating polarized or time-resolved spectra where coherence or population transfer between otherwise isolated manifolds must be tracked.</p>
<section id="usage">
<h4>Usage<a class="headerlink" href="#usage" title="Link to this heading"></a></h4>
<p>Concatenation requires all samples to have compatible parameters:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mars</span><span class="w"> </span><span class="kn">import</span> <span class="n">concat</span><span class="p">,</span> <span class="n">spin_model</span>

<span class="c1"># Define two independent triplet samples with same broadening</span>
<span class="n">g1</span> <span class="o">=</span> <span class="n">spin_model</span><span class="o">.</span><span class="n">Interaction</span><span class="p">(</span><span class="mf">2.002</span><span class="p">)</span>
<span class="n">D1</span> <span class="o">=</span> <span class="n">spin_model</span><span class="o">.</span><span class="n">DEInteraction</span><span class="p">([</span><span class="mf">350e6</span><span class="p">,</span> <span class="mf">50e6</span><span class="p">])</span>
<span class="n">triplet_1</span> <span class="o">=</span> <span class="n">spin_model</span><span class="o">.</span><span class="n">SpinSystem</span><span class="p">(</span>
    <span class="n">electrons</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">],</span>
    <span class="n">g_tensors</span><span class="o">=</span><span class="p">[</span><span class="n">g1</span><span class="p">],</span>
    <span class="n">electron_electron</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">D1</span><span class="p">)]</span>
<span class="p">)</span>

<span class="n">sample_1</span> <span class="o">=</span> <span class="n">spin_model</span><span class="o">.</span><span class="n">MultiOrientedSample</span><span class="p">(</span>
    <span class="n">base_spin_system</span><span class="o">=</span><span class="n">triplet_1</span><span class="p">,</span>
    <span class="n">gauss</span><span class="o">=</span><span class="mf">0.0015</span><span class="p">,</span>
    <span class="n">lorentz</span><span class="o">=</span><span class="mf">0.0008</span><span class="p">,</span>
    <span class="n">ham_strain</span><span class="o">=</span><span class="p">[</span><span class="mf">3e6</span><span class="p">,</span> <span class="mf">3e6</span><span class="p">,</span> <span class="mf">8e6</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">g2</span> <span class="o">=</span> <span class="n">spin_model</span><span class="o">.</span><span class="n">Interaction</span><span class="p">([</span><span class="mf">2.006</span><span class="p">,</span> <span class="mf">2.006</span><span class="p">,</span> <span class="mf">2.002</span><span class="p">])</span>
<span class="n">D2</span> <span class="o">=</span> <span class="n">spin_model</span><span class="o">.</span><span class="n">DEInteraction</span><span class="p">([</span><span class="mf">280e6</span><span class="p">,</span> <span class="mf">35e6</span><span class="p">])</span>
<span class="n">triplet_2</span> <span class="o">=</span> <span class="n">spin_model</span><span class="o">.</span><span class="n">SpinSystem</span><span class="p">(</span>
    <span class="n">electrons</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">],</span>
    <span class="n">g_tensors</span><span class="o">=</span><span class="p">[</span><span class="n">g2</span><span class="p">],</span>
    <span class="n">electron_electron</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">D2</span><span class="p">)]</span>
<span class="p">)</span>

<span class="n">sample_2</span> <span class="o">=</span> <span class="n">spin_model</span><span class="o">.</span><span class="n">MultiOrientedSample</span><span class="p">(</span>
    <span class="n">base_spin_system</span><span class="o">=</span><span class="n">triplet_2</span><span class="p">,</span>
    <span class="n">gauss</span><span class="o">=</span><span class="mf">0.0015</span><span class="p">,</span>  <span class="c1"># Must match sample_1</span>
    <span class="n">lorentz</span><span class="o">=</span><span class="mf">0.0008</span><span class="p">,</span>  <span class="c1"># Must match sample_1</span>
    <span class="n">ham_strain</span><span class="o">=</span><span class="p">[</span><span class="mf">3e6</span><span class="p">,</span> <span class="mf">3e6</span><span class="p">,</span> <span class="mf">8e6</span><span class="p">],</span>  <span class="c1"># Must match sample_1</span>
<span class="p">)</span>

<span class="c1"># Concatenate samples</span>
<span class="n">mixture</span> <span class="o">=</span> <span class="n">concat</span><span class="p">([</span><span class="n">sample_1</span><span class="p">,</span> <span class="n">sample_2</span><span class="p">])</span>
<span class="c1"># Equivalent to: spin_model.concat_multioriented_samples([sample_1, sample_2])</span>
</pre></div>
</div>
<p><strong>See also</strong>: <code class="xref py py-func docutils literal notranslate"><span class="pre">mars.spin_model.concat_multioriented_samples()</span></code> for implementation details and validation logic.</p>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="base_spin_system.html" class="btn btn-neutral float-left" title="Base Spin System" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="spectrum_constraction.html" class="btn btn-neutral float-right" title="EPR Spectrum Construction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, Arkady Samsonenko, Ivan Kurgansky.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>